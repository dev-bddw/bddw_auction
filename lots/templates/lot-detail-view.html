{% extends 'base.html' %}
{% load crispy_forms_tags %}


{% block content %}
    <div class ="container">
        <div class="text-center">
            <h1 style="font-size: 24px" class="title pt-5 mb-4">LOT 087 -  85â€³ BRONZE CREDENZA WITH DARK PATINAED BRONZE EXTERIOR AND BERRY FACES</h1>
            <img style="" src="https://bddwacution-sitedata.s3.us-east-2.amazonaws.com/wp-content/uploads/2022/01/13174405/89407221060030-1.jpg" width="855" height="684">
        </div>
    </div>
    <div class="pt-5 container lot-description text-center" >
        <div>
        <p>LOT DESCRIPTION</p>
        </div>
    </div>
    <div class="bid-container" hx-get="/lots/poll/1" hx-trigger="every 5s" hx-swap="outerHTML">
        {% if lot.is_over %}
        <div class="text-center auction-closed">
            <h1>This Auction Lot has closed</h1>
            <p>High Bid: {{lot.current_high_bid}}</p>
        </div>
        {% else %}
        <div class="pt-5 text-center">
            <h2>Current High Bid: {{lot.current_high_bid}}</h2>
            <p>ENDS {{ lot.end_time }}</p>
            <p>{{lot.end_time|timeuntil}}</p>
        </div>
        <div class="text-center">
            <form hx-post="{% url 'lots:bid' lot.pk %}" _="on htmx:afterOnLoad wait 10ms then add .show to #modal then add .show to #modal-backdrop" hx-trigger="submit" hx-target="#modals-here" hx-swap="outerHTML">
                {% csrf_token %}
                {{ form.as_p }}
                <button type="submit" class="btn btn-dark">BID</button>
            </form>
        </div>
        {% endif %}
    </div>
{% endblock content %}

{% block inline_javascript %}
<script>
    function closeModal() {
        var container = document.getElementById("modals-here")
        var backdrop = document.getElementById("modal-backdrop")
        var modal = document.getElementById("modal")

        modal.classList.remove("show")
        backdrop.classList.remove("show")
        location.reload()

        setTimeout(function() {
            container.removeChild(backdrop)
            container.removeChild(modal)
        }, 200)
    }
</script>
{% endblock inline_javascript %}
